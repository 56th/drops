struct RawRuleCL
{
    int ChildNum;
    int Children[8][4];
};

// Vertices of a given child;
// A tetrahedron can have 94 different children (including itself, that is),
// which are listed here in the following order:
// 1) The first eight tetrahedrons are those of the regular refinement-rule
//    in lexicographical order.
// 2) Then follow all other, also in lexicographical order.
const DROPS::Ubyte VertOfChildAr[DROPS::NumAllChildrenC][DROPS::NumVertsC]= {
    {0, 4, 5, 7}, {4, 1, 6, 8}, {4, 5, 6, 8}, {4, 5, 7, 8}, {5, 6, 2, 9}, {5, 6, 8, 9},
    {5, 7, 8, 9}, {7, 8, 9, 3},
    {0, 1, 2, 3}, {0, 1, 2, 7}, {0, 1, 2, 8}, {0, 1, 2, 9}, {0, 1, 5, 3}, {0, 1, 5, 7}, 
    {0, 1, 5, 8}, {0, 1, 6, 3}, {0, 1, 6, 7}, {0, 1, 6, 8}, {0, 1, 9, 3}, {0, 2, 8, 3}, 
    {0, 2, 8, 9}, {0, 4, 2, 3}, {0, 4, 2, 7}, {0, 4, 2, 9}, {0, 4, 5, 3}, {0, 4, 9, 3},
    {0, 5, 8, 3}, {0, 6, 2, 3}, {0, 6, 2, 7}, {0, 6, 2, 9}, {0, 6, 8, 3}, {0, 6, 8, 9},
    {0, 6, 9, 3}, {0, 8, 9, 3}, {1, 2, 7, 3}, {1, 2, 7, 8}, {1, 2, 7, 9}, {1, 5, 2, 3},
    {1, 5, 2, 8}, {1, 5, 2, 9}, {1, 5, 6, 3}, {1, 5, 6, 7}, {1, 5, 6, 8}, {1, 5, 7, 3},
    {1, 5, 7, 8}, {1, 5, 7, 9}, {1, 5, 9, 3}, {1, 6, 7, 3}, {1, 6, 7, 8}, {1, 7, 9, 3},
    {2, 7, 8, 3}, {2, 7, 8, 9}, {4, 1, 2, 3}, {4, 1, 2, 8}, {4, 1, 2, 9}, {4, 1, 6, 3},
    {4, 1, 9, 3}, {4, 2, 7, 3}, {4, 2, 7, 8}, {4, 2, 7, 9}, {4, 2, 8, 3}, {4, 2, 8, 9},
    {4, 5, 2, 3}, {4, 5, 2, 8}, {4, 5, 2, 9}, {4, 5, 6, 3}, {4, 5, 6, 9}, {4, 5, 7, 3},
    {4, 5, 7, 9}, {4, 5, 8, 3}, {4, 5, 9, 3}, {4, 6, 2, 3}, {4, 6, 2, 7}, {4, 6, 2, 9},
    {4, 6, 7, 8}, {4, 6, 8, 3}, {4, 6, 8, 9}, {4, 6, 9, 3}, {4, 7, 8, 9}, {4, 7, 9, 3},
    {4, 8, 9, 3}, {5, 2, 8, 3}, {5, 2, 8, 9}, {5, 6, 2, 3}, {5, 6, 7, 9}, {5, 6, 8, 3},    
    {5, 6, 9, 3}, {5, 7, 8, 3}, {5, 8, 9, 3}, {6, 2, 7, 3}, {6, 2, 7, 9}, {6, 7, 8, 3},
    {6, 7, 8, 9}, {6, 7, 9, 3} };

RawRuleCL RawRules[64]= {
    {1, {{0, 1, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {2, {{0, 4, 2, 3}, {4, 1, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {2, {{0, 1, 5, 3}, {1, 5, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 4, 5, 3}, {4, 1, 2, 3}, {4, 5, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {2, {{0, 1, 6, 3}, {0, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 4, 2, 3}, {4, 1, 6, 3}, {4, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 5, 3}, {1, 5, 6, 3}, {5, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 5, 3}, {4, 1, 6, 3}, {4, 5, 6, 3}, {5, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {2, {{0, 1, 2, 7}, {1, 2, 7, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 4, 2, 7}, {4, 1, 2, 3}, {4, 2, 7, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 5, 7}, {1, 5, 2, 3}, {1, 5, 7, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 5, 7}, {4, 1, 2, 3}, {4, 5, 2, 3}, {4, 5, 7, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 6, 7}, {0, 6, 2, 7}, {1, 6, 7, 3}, {6, 2, 7, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 2, 7}, {4, 1, 6, 3}, {4, 2, 7, 3}, {4, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 5, 7}, {1, 5, 6, 3}, {1, 5, 7, 3}, {5, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 5, 7}, {4, 1, 6, 3}, {4, 5, 6, 3}, {4, 5, 7, 3}, {5, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {2, {{0, 1, 2, 8}, {0, 2, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 4, 2, 3}, {4, 1, 2, 8}, {4, 2, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 5, 8}, {0, 5, 8, 3}, {1, 5, 2, 8}, {5, 2, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 5, 3}, {4, 1, 2, 8}, {4, 2, 8, 3}, {4, 5, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 6, 8}, {0, 6, 2, 3}, {0, 6, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 2, 3}, {4, 1, 6, 8}, {4, 6, 2, 3}, {4, 6, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 1, 5, 8}, {0, 5, 8, 3}, {1, 5, 6, 8}, {5, 6, 2, 3}, {5, 6, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 5, 3}, {4, 1, 6, 8}, {4, 5, 6, 3}, {4, 6, 8, 3}, {5, 6, 2, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 2, 7}, {1, 2, 7, 8}, {2, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 2, 7}, {2, 7, 8, 3}, {4, 1, 2, 8}, {4, 2, 7, 8}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 1, 5, 7}, {1, 5, 2, 8}, {1, 5, 7, 8}, {5, 2, 8, 3}, {5, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 5, 7}, {4, 1, 2, 8}, {4, 5, 2, 8}, {4, 5, 7, 8}, {5, 2, 8, 3}, {5, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 1, 6, 7}, {0, 6, 2, 7}, {1, 6, 7, 8}, {6, 2, 7, 3}, {6, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 2, 7}, {4, 1, 6, 8}, {4, 6, 2, 7}, {4, 6, 7, 8}, {6, 2, 7, 3}, {6, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 1, 5, 7}, {1, 5, 6, 8}, {1, 5, 7, 8}, {5, 6, 2, 3}, {5, 6, 8, 3}, {5, 7, 8, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {7, {{0, 4, 5, 7}, {4, 1, 6, 8}, {4, 5, 6, 8}, {4, 5, 7, 8}, {5, 6, 2, 3}, {5, 6, 8, 3}, {5, 7, 8, 3}, {-1, -1, -1, -1}} },
    {2, {{0, 1, 2, 9}, {0, 1, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 4, 2, 9}, {0, 4, 9, 3}, {4, 1, 2, 9}, {4, 1, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 5, 3}, {1, 5, 2, 9}, {1, 5, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 5, 3}, {4, 1, 2, 9}, {4, 1, 9, 3}, {4, 5, 2, 9}, {4, 5, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 6, 3}, {0, 6, 2, 9}, {0, 6, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 2, 9}, {0, 4, 9, 3}, {4, 1, 6, 3}, {4, 6, 2, 9}, {4, 6, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 5, 3}, {1, 5, 6, 3}, {5, 6, 2, 9}, {5, 6, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 5, 3}, {4, 1, 6, 3}, {4, 5, 6, 3}, {5, 6, 2, 9}, {5, 6, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 2, 7}, {1, 2, 7, 9}, {1, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 2, 7}, {4, 1, 2, 9}, {4, 1, 9, 3}, {4, 2, 7, 9}, {4, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 5, 7}, {1, 5, 2, 9}, {1, 5, 7, 9}, {1, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 5, 7}, {4, 1, 2, 9}, {4, 1, 9, 3}, {4, 5, 2, 9}, {4, 5, 7, 9}, {4, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 1, 6, 7}, {0, 6, 2, 7}, {1, 6, 7, 3}, {6, 2, 7, 9}, {6, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 2, 7}, {4, 1, 6, 3}, {4, 2, 7, 9}, {4, 6, 2, 9}, {4, 6, 9, 3}, {4, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 1, 5, 7}, {1, 5, 6, 7}, {1, 6, 7, 3}, {5, 6, 2, 9}, {5, 6, 7, 9}, {6, 7, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {7, {{0, 4, 5, 7}, {4, 1, 6, 3}, {4, 5, 6, 9}, {4, 5, 7, 9}, {4, 6, 9, 3}, {4, 7, 9, 3}, {5, 6, 2, 9}, {-1, -1, -1, -1}} },
    {3, {{0, 1, 2, 8}, {0, 2, 8, 9}, {0, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 2, 9}, {0, 4, 9, 3}, {4, 1, 2, 8}, {4, 2, 8, 9}, {4, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 1, 5, 8}, {0, 5, 8, 3}, {1, 5, 2, 8}, {5, 2, 8, 9}, {5, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 5, 3}, {4, 1, 2, 8}, {4, 5, 2, 8}, {4, 5, 8, 3}, {5, 2, 8, 9}, {5, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 6, 8}, {0, 6, 2, 9}, {0, 6, 8, 9}, {0, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 4, 2, 9}, {0, 4, 9, 3}, {4, 1, 6, 8}, {4, 6, 2, 9}, {4, 6, 8, 9}, {4, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 1, 5, 8}, {0, 5, 8, 3}, {1, 5, 6, 8}, {5, 6, 2, 9}, {5, 6, 8, 9}, {5, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {7, {{0, 4, 5, 3}, {4, 1, 6, 8}, {4, 5, 6, 8}, {4, 5, 8, 3}, {5, 6, 2, 9}, {5, 6, 8, 9}, {5, 8, 9, 3}, {-1, -1, -1, -1}} },
    {4, {{0, 1, 2, 7}, {1, 2, 7, 8}, {2, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {5, {{0, 4, 2, 7}, {2, 7, 8, 9}, {4, 1, 2, 8}, {4, 2, 7, 8}, {7, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {6, {{0, 1, 5, 7}, {1, 5, 2, 8}, {1, 5, 7, 8}, {5, 2, 8, 9}, {5, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {7, {{0, 4, 5, 7}, {4, 1, 2, 8}, {4, 5, 2, 8}, {4, 5, 7, 8}, {5, 2, 8, 9}, {5, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}} },
    {6, {{0, 1, 6, 7}, {0, 6, 2, 7}, {1, 6, 7, 8}, {6, 2, 7, 9}, {6, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}, {-1, -1, -1, -1}} },
    {7, {{0, 4, 2, 7}, {4, 1, 6, 8}, {4, 2, 7, 9}, {4, 6, 2, 9}, {4, 6, 8, 9}, {4, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}} },
    {7, {{0, 1, 5, 7}, {1, 5, 6, 8}, {1, 5, 7, 8}, {5, 6, 2, 9}, {5, 6, 8, 9}, {5, 7, 8, 9}, {7, 8, 9, 3}, {-1, -1, -1, -1}} },
    {8, {{0, 4, 5, 7}, {4, 1, 6, 8}, {4, 5, 6, 8}, {4, 5, 7, 8}, {5, 6, 2, 9}, {5, 6, 8, 9}, {5, 7, 8, 9}, {7, 8, 9, 3}} }
    };
