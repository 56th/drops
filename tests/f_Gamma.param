#=============================================================
#    DROPS parameter file
#    simulation of two-phase flow: 
#    study effect of pressure jump for different FE spaces
#=============================================================

# time stepping
Time {
  NumSteps	=	10
  StepSize	=	1.0
  Scheme        =       1
}

# flow solver
Stokes {
  StokesMethod	=	99	# no effect
  InnerIter	=	1000
  OuterIter	=	200
  InnerTol	=	1e-14
  OuterTol	=	1e-12
  StokesMethod	=	-1	# no effect
  PcAIter	=       2
  PcATol	=	1e-2
  PcSTol	=	1e-4
  XFEMStab      =       1e-1
  Theta         =       1       # IE
}

NavStokes {
  Nonlinear     =       0
  Tol           =       5e-10
  Iter          =       20
  Reduction     =       0.1
}

# levelset solver
Levelset {
  Tol		=	1e-14
  Iter		=	10000
  SD		=	0
  CurvDiff	=	-5e-9
  VolCorrection	=	0
  Theta         =       1       # IE
}

Coupling {
  Tol		=	1
  Iter		=	-1
  Stab		=	0
  Projection=	0
}

# re-initialization of levelset function
Reparam { 
  Method	=	1
  Freq		=	0
  MinGrad	=	0.1
  MaxGrad	=	10
  NarrowBand    =       -1.0
}

# material data, all units are SI
Mat {
  DensDrop	=	1e3
  ViscDrop	=	1e-3
  DensFluid	=	1e3
  ViscFluid	=	1e-3	
  SmoothZone=	1e-5
}

# experimental conditions
Exp {
  RadDrop = 0.5 0.5 0.5		# radius of ball (only x-component will be considered)
#  PosDrop = 0.3e-2 0.4e-2 -0.1e-2
  PosDrop = 0 0 0			# position of ball
  
  Gravity	=	0	0	0
  
  FlowDir	=	1
  
  InflowVel	=	-0.14
  RadInlet	=	3.5e-3
  InflowFreq	=	0
  InflowAmpl	=	0
}  

# adaptive refinement
AdaptRef {
  Freq		=	0
  FinestLevel	=	2	# num of refinements
  CoarsestLevel =       0
  Width		=	4.9e-4
  RefineStrategy=       1
}

# surface tension
SurfTens {
  VarTension	=	0
  SurfTension	=	1
  JumpWidth		=	5e-4
  RelPos		=	1.5
  DirtFactor	=	0.8
}

# mass transport
Transp {
  DoTransp	=	0
  Theta		=	0.5
  Iter		=	200
  Tol		=	1e-10
  DiffPos	=	5e-3
  DiffNeg	=	1e-2
  H			=	0.5
  IniCPos	=	0.1
  IniCNeg	=	5
  NitschePenalty=       0
  NitscheXFEMStab=      0
}
# Ensight settings
Ensight {
  EnsightOut    =       1
  EnsCase       =       xxx
  EnsDir        =       xxx
  Binary        =       1
  MasterOut     =       1
  GeomName      =       xxx
}

#VTK output
VTK{
  VTKOut        = 0
  VTKDir        = xxx
  VTKName       = xxx
  Binary        = 0
}

# domain, bnd/ini conditions
DomainCond {
  InitialCond   =       1       # 0=zero, 1/2=flow with/without drop, -1=read from file
  GeomType      =       -1
  InitialFile   =       xxx
  MeshFile      =       2x2x2@5x5x5     # size and num subdivisions of cube
  BoundaryType  =       1       # boundary type: 0= meas. cell, 1= hom. Dirichlet, 2= inhom. Dirichlet
}

# restart computation
Restart {
  Inputfile     =       none
  Outputfile    =       none
  Overwrite     =       1
  Serialization =       1
}