(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78352,       2088]
NotebookOptionsPosition[     76133,       2050]
NotebookOutlinePosition[     76467,       2065]
CellTagsIndexPosition[     76424,       2062]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Needs", "[", "\"\<VectorAnalysis`\>\"", "]"}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"cb7e5e64-ade4-465f-b1a2-1979b9dc3e13"],

Cell[CellGroupData[{

Cell["Compute data for given exact solution", "Title",
 CellChangeTimes->{{3.769311890857476*^9, 
  3.76931192323981*^9}},ExpressionUUID->"ddff3a6e-de58-4dc2-a5f6-\
6aba49abab55"],

Cell[CellGroupData[{

Cell["Input data", "Section",
 CellChangeTimes->{{3.76931194099603*^9, 
  3.769311944607621*^9}},ExpressionUUID->"24d33754-7378-44e1-be37-\
ff2a0ec28ec6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"case", "=", "\"\<OseenBubbleDirection\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.778885963634405*^9, 3.778885979240247*^9}, {
   3.778887883208609*^9, 3.778887883494611*^9}, {3.7789621553070173`*^9, 
   3.7789621683533916`*^9}, {3.7789689407429447`*^9, 3.778968941894186*^9}, {
   3.7789695440925713`*^9, 3.778969546741921*^9}, {3.778969960760661*^9, 
   3.7789699686505823`*^9}, {3.778970082182988*^9, 3.77897008437202*^9}, {
   3.778974177801334*^9, 3.778974183696604*^9}, 3.779308623163287*^9, 
   3.779577466840234*^9, 3.782837807674684*^9, {3.782850149324807*^9, 
   3.78285015281958*^9}, {3.8088449386617804`*^9, 3.808844942314533*^9}, {
   3.815261433079803*^9, 3.815261434536532*^9}, 3.815269645969656*^9, {
   3.815604045251615*^9, 3.815604051739492*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"1b465777-73e9-484f-ac7e-1989af4e14e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"case", ",", "\"\<Sphere\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"], "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"point", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "@", "3"}]}], ",", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "@", "3"}]}], ",", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "@", "3"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"L", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "L"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<x\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<y\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<z\>\""}], "}"}], ",", "L"}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vPoint", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "5"}], "L"}], ",", "0"}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"case", ",", "\"\<Torus\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["z", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}], "]"}], "-", "1"}], ")"}], "2"]}], 
        "]"}], "-", 
       RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox["z", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}], "]"}], "-", "1"}], ")"}], "2"], "-", 
       RowBox[{"1", "/", "4"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"], "+", 
          SuperscriptBox["R", "2"], "-", 
          SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
       RowBox[{"4", 
        SuperscriptBox["R", "2"], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"d", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"point", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "@", "2"}], "/", "2"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", "+", "r"}], ",", 
         RowBox[{"R", "+", "r"}], ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"5", "/", "3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<x\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<y\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<z\>\""}], "}"}], ",", 
          RowBox[{"L", "/", "2"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vPoint", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "5"}], "L"}], ",", 
        RowBox[{"3", "L"}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"case", ",", "\"\<Bubble\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"r0", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"1", "/", "10"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", "t_", "]"}], ":=", 
      RowBox[{"r0", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", "Pi", " ", "t"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], "]"}], "-", 
       RowBox[{"r", "[", "t", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "[", "t", "]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"5", "/", "3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tRand", "=", 
      RowBox[{"RandomReal", "@", "T"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"point", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"point", "/=", 
      RowBox[{"Norm", "@", "point"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"point", "*=", 
      RowBox[{"r", "[", "tRand", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "L"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<x\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<y\>\""}], "}"}], ",", "L"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<z\>\""}], "}"}], ",", "L"}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vPoint", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "5"}], "L"}], ",", "0"}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d = \>\"", ",", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"point", ",", "tRand"}], "]"}], "//", "Simplify"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eHoYw4T/TeOX4LWiIHo7bkXZUF0UJKUHIienWbT
cjrhjeMc03Qwvenb/oUgWoP7GJgWvHpyOYg+5mq6HkQfZnDfAaIrLO/vAtEZ
KlwnQfSaF3ZnQfStW3OvgujQ2Ps3QPQEzs3fQfQ786+/QPSWWSIBHLlvHG1l
zgWD6LxJpREg+lvQnHQQ3ckRsBBEf/cWWg6iE771bgLRMguDNoPoMxXrboDo
CdPfgOnz61hSeYA06zvPNBD94/ijh+uB9IJ3816A6BPZbowbgHRU1HxBEJ0k
JFywEUhPu3e3EEQnqv3i2wSkr0m28YPo1MvMYiD6h044mAYArPylzw==
  "],
 CellLabel->"In[7]:=",ExpressionUUID->"a7d83c33-6ec5-4367-ba96-a9bfbcbb65dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uN", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
       "t"}], "]"}]}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shiftedPoint", "=", 
   RowBox[{"point", "+", 
    RowBox[{"n", "[", 
     RowBox[{"point", ",", "tRand"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ext", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
      RowBox[{"n", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}]}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"n", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
        "}"}]}], ".", 
      RowBox[{"{", 
       RowBox[{"n", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "}"}]}]}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\!\(\*SubscriptBox[\(u\), \(N\)]\) = \>\"", ",", 
   RowBox[{"uN", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<e = \>\"", ",", 
   RowBox[{
    RowBox[{"ext", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "//", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<n = \>\"", ",", 
   RowBox[{
    RowBox[{"n", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "//", 
    "MatrixForm"}]}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<P = \>\"", ",", 
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "//", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<H = \>\"", ",", 
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "//", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"point", ",", "tRand"}], "]"}], "!=", 
    RowBox[{"P", "[", 
     RowBox[{"shiftedPoint", ",", "tRand"}], "]"}]}], ",", 
   RowBox[{"Print", "[", "\"\<wrong P\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"P", "[", 
       RowBox[{"point", ",", "tRand"}], "]"}], ")"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{"point", ",", "tRand"}], "]"}]}], "\[NotEqual]", 
    RowBox[{"H", "[", 
     RowBox[{"point", ",", "tRand"}], "]"}]}], ",", 
   RowBox[{"Print", "[", "\"\<wrong H\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7691769635975237`*^9, 3.769176980446547*^9}, 
   3.769177769710428*^9, 3.769191457377654*^9, {3.769191872400544*^9, 
   3.769191872618865*^9}, {3.769312167636168*^9, 3.769312186915535*^9}, {
   3.769321268408288*^9, 3.7693213389673023`*^9}, 3.7693213807220573`*^9, {
   3.769322463867075*^9, 3.769322463961042*^9}, {3.769327261519408*^9, 
   3.769327285175581*^9}, {3.7693273987454033`*^9, 3.769327409597411*^9}, {
   3.769491105557446*^9, 3.7694911105478477`*^9}, 3.769857695247761*^9, {
   3.7699008833614902`*^9, 3.7699008848157873`*^9}, {3.769923093445156*^9, 
   3.769923104286748*^9}, {3.769927908233202*^9, 3.769927922585454*^9}, {
   3.769927960972287*^9, 3.7699279977604628`*^9}, {3.772834314392605*^9, 
   3.772834317995165*^9}, {3.7788862801021433`*^9, 3.778886280703269*^9}, {
   3.7788864452747307`*^9, 3.77888649595432*^9}, {3.778886545169334*^9, 
   3.778886568913251*^9}, {3.77888660595438*^9, 3.778886781430359*^9}, {
   3.778886854649789*^9, 3.778886855068822*^9}, {3.778888000268742*^9, 
   3.778888007560042*^9}, {3.808845620990781*^9, 3.808845697762555*^9}, {
   3.808845748501751*^9, 3.808845748639555*^9}, {3.8088458012846537`*^9, 
   3.80884582096628*^9}, {3.815261523548271*^9, 3.8152615465136766`*^9}, {
   3.815261618909156*^9, 3.815261737808152*^9}, {3.81526177859556*^9, 
   3.8152617890763702`*^9}, {3.815261823039728*^9, 3.81526182827824*^9}, {
   3.815261887725753*^9, 3.8152618878706493`*^9}, {3.8152674564162397`*^9, 
   3.8152675858756733`*^9}, {3.8152677231629257`*^9, 3.81526785125077*^9}, {
   3.815269353473946*^9, 3.8152693724592524`*^9}, {3.815604432398643*^9, 
   3.815604469784746*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cef2d6ba-4484-4616-8d39-ed15a2198b77"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"SliceVectorPlot3D", "[", 
    RowBox[{
     RowBox[{"n", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "\[Equal]", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}]}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "ticks"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "vPoint"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.815604508596326*^9, 3.8156045387521048`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"f656aa0a-5efd-4d98-b8d2-1a7d6fbf2811"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"surfGrad", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
      RowBox[{"Grad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ")"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfVectGrad", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
      RowBox[{"Grad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ".", 
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], ")"}],
     "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Es", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"surfVectGrad", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", "#", "]"}], "+", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"surfVectGrad", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", "#", "]"}], "]"}]}], 
      ")"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfVectDiv", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"surfVectGrad", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", "#", "]"}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfMatDiv", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"surfVectDiv", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"surfVectDiv", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"surfVectDiv", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfCurl", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"surfVectDiv", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"#", ",", 
       RowBox[{"n", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], 
      "]"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfVectCurl", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
      RowBox[{
       RowBox[{"surfGrad", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", "#", "]"}]}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conv", "[", 
    RowBox[{"w_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
         
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.78284790633313*^9, 3.7828479233179703`*^9}, {
  3.782847966654647*^9, 3.78284804311895*^9}, {3.782848649610663*^9, 
  3.78284865280759*^9}, {3.782848712292397*^9, 3.782848760783701*^9}, {
  3.815605683105967*^9, 3.8156056834614887`*^9}, {3.815605851379798*^9, 
  3.815605888248745*^9}, {3.815605918438922*^9, 3.815605933729537*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ce38ec79-34d2-4b62-a452-7b3a352b89f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"case", "\[Equal]", "\"\<StokesBubbleDirection\>\""}], "||", 
     RowBox[{"case", "\[Equal]", "\"\<OseenBubbleDirection\>\""}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"uOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"2", "t"}]}], ",", "0", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=",
       "0"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"case", "\[Equal]", "\"\<StokesSphere\>\""}], "||", 
     RowBox[{"case", "\[Equal]", "\"\<OseenSphere\>\""}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"uOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["z", "2"]}], ",", "y", ",", "x"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"x", " ", 
        SuperscriptBox["y", "3"]}], "+", "z"}]}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"case", "\[Equal]", "\"\<StokesSphereSimple\>\""}], "||", 
     RowBox[{"case", "\[Equal]", "\"\<OseenSphereSimple\>\""}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"uOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=",
       "0"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"case", "\[Equal]", "\"\<KelvinHelmholtzCristophTorus\>\""}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"shiftInt", "[", 
       RowBox[{"t_", ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"c", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"d", "-", "c"}], 
         RowBox[{"b", "-", "a"}]], 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]a", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "Last"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]a", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "Last"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"shiftInt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CoordinatesFromCartesian", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Spherical"}], 
          "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]a", ",", "\[Xi]b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"shiftInt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CoordinatesFromCartesian", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Spherical"}], 
          "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Eta]a", ",", "\[Eta]b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"surfGrad", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}]}], 
         "]"}]}], "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e\[Eta]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"surfGrad", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Eta]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Eta]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}]}], 
         "]"}]}], "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"uInf", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ma", "=", "16"}], ";", "\[IndentingNewLine]", 
     RowBox[{"aa", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mb", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ab", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cn", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]0", "=", 
      RowBox[{"1", "/", "20"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zDist", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"R", "-", "r"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Hs", "[", "t_", "]"}], ":=", 
      RowBox[{"Tanh", "[", 
       RowBox[{"2", 
        RowBox[{"t", "/", "\[Delta]0"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{"uInf", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "/", "\[Delta]0"}], 
           ")"}], "2"]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aa", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"ma", " ", "Pi", " ", 
            RowBox[{"\[Xi]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "+", 
         RowBox[{"ab", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"mb", " ", "Pi", " ", 
            RowBox[{"\[Xi]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uPert", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"cn", " ", 
        RowBox[{
         RowBox[{"surfVectCurl", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Psi]", "@", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Hs", "[", 
         RowBox[{"\[Eta]", "@", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "uInf", " ", 
        RowBox[{"zDist", "[", 
         RowBox[{"x", ",", "y"}], "]"}], 
        RowBox[{"e\[Xi]", "@", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=",
       "0"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"case", "==", "\"\<KelvinHelmholtzCristophSphere\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"shiftInt", "[", 
       RowBox[{"t_", ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"c", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"d", "-", "c"}], 
         RowBox[{"b", "-", "a"}]], 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]a", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "Last"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]a", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoordinateRanges", "[", "Spherical", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "Last"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"shiftInt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CoordinatesFromCartesian", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Spherical"}], 
          "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]a", ",", "\[Xi]b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"shiftInt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CoordinatesFromCartesian", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Spherical"}], 
          "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Eta]a", ",", "\[Eta]b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"surfGrad", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}]}], 
         "]"}]}], "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e\[Eta]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"surfGrad", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Eta]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}], ".", 
          RowBox[{
           RowBox[{"surfGrad", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
           RowBox[{"\[Eta]", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "]"}]}], 
         "]"}]}], "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"uInf", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ma", "=", "16"}], ";", "\[IndentingNewLine]", 
     RowBox[{"aa", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mb", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ab", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cn", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]0", "=", 
      RowBox[{"1", "/", "20"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", "z_", "]"}], ":=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox["z", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Hs", "[", "t_", "]"}], ":=", 
      RowBox[{"Tanh", "[", 
       RowBox[{"2", 
        RowBox[{"t", "/", "\[Delta]0"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{"uInf", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "/", "\[Delta]0"}], 
           ")"}], "2"]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"aa", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"ma", " ", "Pi", " ", 
            RowBox[{"\[Xi]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "+", 
         RowBox[{"ab", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"mb", " ", "Pi", " ", 
            RowBox[{"\[Xi]", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uPert", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"cn", " ", 
        RowBox[{
         RowBox[{"surfVectCurl", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"\[Psi]", "@", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Hs", "[", 
         RowBox[{"\[Eta]", "@", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "uInf", " ", 
        FractionBox[
         RowBox[{"r", "[", "z", "]"}], "R"], 
        RowBox[{"e\[Xi]", "@", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pOriginal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=",
       "0"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.778885986808414*^9, 3.778886033830266*^9}, {
   3.778886067268861*^9, 3.778886147429928*^9}, {3.778886178858304*^9, 
   3.7788861819299183`*^9}, {3.7788863503877087`*^9, 3.778886391073475*^9}, 
   3.778886870884848*^9, {3.778887415672515*^9, 3.778887427491746*^9}, {
   3.778887708949358*^9, 3.778887866387261*^9}, {3.778887925421589*^9, 
   3.778887931414765*^9}, {3.7788879625512867`*^9, 3.7788879662730293`*^9}, {
   3.778888045721334*^9, 3.778888050304082*^9}, {3.778888083294516*^9, 
   3.77888809280542*^9}, {3.778888163643434*^9, 3.7788881663453503`*^9}, {
   3.77888834025226*^9, 3.778888340581135*^9}, {3.778888393618544*^9, 
   3.778888397529566*^9}, 3.778888942077401*^9, {3.7788889732820997`*^9, 
   3.7788889753855247`*^9}, {3.778962094690949*^9, 3.778962128793132*^9}, {
   3.7789622421649513`*^9, 3.7789622624370728`*^9}, {3.778969530108473*^9, 
   3.77896954091334*^9}, {3.778969945369361*^9, 3.7789699569605293`*^9}, {
   3.7793085434327707`*^9, 3.779308674490695*^9}, {3.779308767604927*^9, 
   3.779308787859558*^9}, {3.779308902294072*^9, 3.779308902703951*^9}, {
   3.779308943144672*^9, 3.779308947493297*^9}, {3.779309024365506*^9, 
   3.779309026082205*^9}, {3.779312183135538*^9, 3.7793122151692047`*^9}, {
   3.779312354008398*^9, 3.779312359717767*^9}, {3.779312549489965*^9, 
   3.7793125501577597`*^9}, {3.779312745364437*^9, 3.779312746517207*^9}, {
   3.779313206988357*^9, 3.7793132461261578`*^9}, {3.779313328506962*^9, 
   3.779313358792197*^9}, {3.779313391659348*^9, 3.779313515583918*^9}, {
   3.7793137610934677`*^9, 3.77931377448209*^9}, {3.779313899437924*^9, 
   3.779313940924271*^9}, {3.77931397912633*^9, 3.779313995767918*^9}, {
   3.779314047010445*^9, 3.779314079242928*^9}, {3.7793141873276997`*^9, 
   3.779314199139085*^9}, 3.7793143494679203`*^9, {3.7793144151707907`*^9, 
   3.779314415833702*^9}, {3.779314566678381*^9, 3.779314573663796*^9}, {
   3.779316152178708*^9, 3.779316154695901*^9}, {3.7793161918684387`*^9, 
   3.779316195436038*^9}, {3.77957743586791*^9, 3.779577455700067*^9}, {
   3.782836362761778*^9, 3.782836405936256*^9}, {3.7828364497920218`*^9, 
   3.782836505999551*^9}, {3.782836577420765*^9, 3.7828366387849493`*^9}, {
   3.782836682345635*^9, 3.782836757799761*^9}, {3.782837362216126*^9, 
   3.782837387999065*^9}, {3.7828378583272867`*^9, 3.782837885446862*^9}, {
   3.782844146861865*^9, 3.782844178863803*^9}, {3.7828444817922792`*^9, 
   3.782844482205895*^9}, {3.782844632805706*^9, 3.782844647832655*^9}, {
   3.782846144045001*^9, 3.782846156124522*^9}, {3.782846277926997*^9, 
   3.7828462783092413`*^9}, {3.782847001326573*^9, 3.782847062337817*^9}, {
   3.782847148441352*^9, 3.7828471921741734`*^9}, {3.7828472242002583`*^9, 
   3.782847318047803*^9}, {3.782847368685801*^9, 3.782847370049376*^9}, {
   3.782847484059246*^9, 3.782847720687894*^9}, 3.7828477623929367`*^9, {
   3.7828478100390987`*^9, 3.782847855685741*^9}, {3.7828480816239862`*^9, 
   3.7828481404319153`*^9}, {3.782848173924666*^9, 3.7828481902562637`*^9}, {
   3.7828484196367598`*^9, 3.7828484215846233`*^9}, {3.782848781128635*^9, 
   3.7828487815524054`*^9}, {3.7828488539385233`*^9, 
   3.7828488674713993`*^9}, {3.78284897840025*^9, 3.782848979985866*^9}, {
   3.782849193751432*^9, 3.7828491966561613`*^9}, {3.7828492466227818`*^9, 
   3.7828492468820753`*^9}, {3.7828495417442923`*^9, 
   3.7828495634968843`*^9}, {3.782850165744789*^9, 3.7828502224400587`*^9}, {
   3.782851186093091*^9, 3.782851195928239*^9}, {3.782851375650242*^9, 
   3.7828513787516823`*^9}, {3.782851441122272*^9, 3.782851471162467*^9}, {
   3.7828536267039213`*^9, 3.782853676059764*^9}, {3.782903696713999*^9, 
   3.782903697239217*^9}, {3.782904113836026*^9, 3.782904114009643*^9}, {
   3.7829298888067293`*^9, 3.782929916402519*^9}, {3.782930023006373*^9, 
   3.7829300316853237`*^9}, {3.782930114974535*^9, 3.782930121597291*^9}, {
   3.782934465965809*^9, 3.782934505967799*^9}, {3.782937322744377*^9, 
   3.782937322982136*^9}, {3.782937442874631*^9, 3.782937443062018*^9}, {
   3.783202372863493*^9, 3.783202400704777*^9}, {3.783202539530814*^9, 
   3.783202541691805*^9}, {3.783202919339301*^9, 3.7832029198158903`*^9}, {
   3.783287771410351*^9, 3.7832877934794073`*^9}, {3.8088459541150417`*^9, 
   3.808845955637129*^9}, {3.808846104235677*^9, 3.808846125413912*^9}, {
   3.80884724177127*^9, 3.808847245237811*^9}, {3.8088472881680202`*^9, 
   3.8088473258052588`*^9}, {3.8088474882086153`*^9, 3.808847507667096*^9}, {
   3.815269022131095*^9, 3.815269077331995*^9}, {3.81526958788379*^9, 
   3.815269602413541*^9}, {3.8156045977895117`*^9, 3.815604698140312*^9}, 
   3.815608694056422*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"0f8c0ba2-eb8b-41c2-b166-6c19debf3f90"],

Cell[BoxData[
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
    
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
     RowBox[{"uOriginal", "[", 
      RowBox[{
       RowBox[{"ext", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
       "t"}], "]"}]}]}], ";", "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
    
    RowBox[{
     RowBox[{"surfCurl", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
     RowBox[{"u", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "]"}]}], 
   ";", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
    
    RowBox[{"pOriginal", "[", 
     RowBox[{
      RowBox[{"ext", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
      "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<u = \>\"", ",", 
     RowBox[{"u", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], "]"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\[Omega] = \>\"", ",", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], "]"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<p = \>\"", ",", 
     RowBox[{"p", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], "]"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"point", ",", "tRand"}], "]"}], "\[NotEqual]", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"point", ",", "tRand"}], "]"}], ".", 
       RowBox[{"u", "[", 
        RowBox[{"point", ",", "tRand"}], "]"}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<u != P u, \>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"point", ",", "tRand"}], "]"}], "-", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"point", ",", "tRand"}], "]"}], ".", 
          RowBox[{"u", "[", 
           RowBox[{"point", ",", "tRand"}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"point", ",", "tRand"}], "]"}], "\[NotEqual]", 
      RowBox[{"u", "[", 
       RowBox[{"shiftedPoint", ",", "tRand"}], "]"}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<u != \!\(\*SuperscriptBox[\(u\), \(e\)]\), \>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"point", ",", "tRand"}], "]"}], "-", 
         RowBox[{"u", "[", 
          RowBox[{"shiftedPoint", ",", "tRand"}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"point", ",", "tRand"}], "]"}], "\[NotEqual]", 
      RowBox[{"p", "[", 
       RowBox[{"shiftedPoint", ",", "tRand"}], "]"}]}], ",", 
     RowBox[{
     "Print", "[", "\"\<p != \!\(\*SuperscriptBox[\(p\), \(e\)]\), \>\"", 
      "]"}], ",", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"point", ",", "tRand"}], "]"}], "-", 
       RowBox[{"p", "[", 
        RowBox[{"shiftedPoint", ",", "tRand"}], "]"}]}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7788869657869*^9, 3.778886992131941*^9}, {
   3.7788870411677437`*^9, 3.778887128210527*^9}, {3.778887307618766*^9, 
   3.7788873309076967`*^9}, {3.77888743600769*^9, 3.778887441145029*^9}, 
   3.778887478030777*^9, 3.7788878918346767`*^9, {3.778962226201314*^9, 
   3.778962234557482*^9}, {3.778962274319786*^9, 3.778962461566596*^9}, {
   3.778962496165098*^9, 3.7789625051354733`*^9}, {3.78284911748567*^9, 
   3.7828491554251223`*^9}, {3.7828495163974047`*^9, 3.7828495216649*^9}, {
   3.782849615065351*^9, 3.782849632263544*^9}, {3.7828496736319523`*^9, 
   3.782849673832233*^9}, {3.7828502446248217`*^9, 3.7828502451742*^9}, {
   3.782850387379819*^9, 3.782850420371964*^9}, {3.7828504540615187`*^9, 
   3.782850467861825*^9}, {3.782850498631394*^9, 3.7828505110767508`*^9}, {
   3.7828505478401823`*^9, 3.782850597579562*^9}, {3.782851050735132*^9, 
   3.7828510977535257`*^9}, {3.782851128729027*^9, 3.78285112904248*^9}, {
   3.782851221629534*^9, 3.782851237974477*^9}, {3.782851278694009*^9, 
   3.7828513099351883`*^9}, {3.782853413037304*^9, 3.782853440239039*^9}, {
   3.782853492191163*^9, 3.782853522798649*^9}, {3.7828536479618196`*^9, 
   3.78285364912586*^9}, {3.782853688222679*^9, 3.7828536992169027`*^9}, {
   3.78285373236101*^9, 3.782853773281468*^9}, {3.782901884541424*^9, 
   3.782901898317726*^9}, {3.782937628396495*^9, 3.78293767839853*^9}, {
   3.815269686667007*^9, 3.8152697080225697`*^9}, {3.815269768376507*^9, 
   3.815269872080635*^9}, {3.81560473148169*^9, 3.815604810141532*^9}, {
   3.815605733108341*^9, 3.815605789638784*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"86e35e52-edc1-4aa3-a7ea-6a9365d2723a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uPlotArrows", "[", "t_", "]"}], ":=", 
   RowBox[{"SliceVectorPlot3D", "[", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "\[Equal]", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"VectorStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "\"\<Arrow3D\>\""}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}]}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "ticks"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "vPoint"}], ",", 
     RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], "]"}]}], 
  ";", 
  RowBox[{
   RowBox[{"uPlotDensity", "[", "t_", "]"}], ":=", 
   RowBox[{"SliceDensityPlot3D", "[", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "\[Equal]", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uPlot", "[", "t_", "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"uPlotArrows", "[", "t", "]"}], ",", 
     RowBox[{"uPlotDensity", "[", "t", "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pPlot", "[", "t_", "]"}], ":=", 
   RowBox[{"SliceDensityPlot3D", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "\[Equal]", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}]}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "ticks"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "vPoint"}], ",", 
     RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]Plot", "[", "t_", "]"}], ":=", 
   RowBox[{"SliceDensityPlot3D", "[", 
    RowBox[{
     RowBox[{"\[Omega]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "\[Equal]", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "Hue"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "L"}]}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "ticks"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "vPoint"}], ",", 
     RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.815604877963128*^9, 3.815604935534258*^9}, {
  3.815604994754939*^9, 3.8156049952263603`*^9}, {3.815605027943962*^9, 
  3.81560516807769*^9}, {3.8156052315259533`*^9, 3.815605299059361*^9}, {
  3.815606027478218*^9, 3.815606066259357*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"f244ed08-f346-4574-9de5-71269a36e9a1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"uPlot", "[", "t", "]"}], ",", 
       RowBox[{"\[Omega]Plot", "[", "t", "]"}], ",", 
       RowBox[{"pPlot", "[", "t", "]"}]}], "}"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.815605388768936*^9, 3.815605431926813*^9}, {
  3.815606076006291*^9, 3.81560608101311*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"f45caea6-abb7-4072-a20a-bd1397219bf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uPlotDensity", "=", 
     RowBox[{"SliceContourPlot3D", "[", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Equal]", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "L"}], ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", ".1"}], ",", ".1"}], "}"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "Hue"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
       RowBox[{"Axes", "->", "False"}], ",", 
       RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"Contours", "\[Rule]", "8"}], ",", 
       RowBox[{"ViewPoint", "\[Rule]", 
        RowBox[{"vPoint", "+", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "L"}], "}"}]}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"uPlot", "=", 
     RowBox[{"Show", "[", 
      RowBox[{"uPlotDensity", ",", 
       RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\</home/alexander/Documents/MKL-Eigs-for-Sparse-Matrices/output/LaTeX/\
img/u_soln.png\>\"", ",", "uPlot", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\</home/alexander/Documents/MKL-Eigs-for-Sparse-Matrices/output/LaTeX/\
img/p_soln.png\>\"", ",", "pPlot", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.769469013384845*^9, 3.769469015897784*^9}, {
  3.769469057686288*^9, 3.769469075438757*^9}, {3.769469158192058*^9, 
  3.769469169654409*^9}, {3.76946943327643*^9, 3.7694694368010178`*^9}, {
  3.769470025926527*^9, 3.76947003096599*^9}, {3.769470200516617*^9, 
  3.769470216619112*^9}, {3.769470286015232*^9, 3.769470286346712*^9}, {
  3.769470323073564*^9, 3.769470323944113*^9}, {3.772836917593025*^9, 
  3.7728369215753517`*^9}, {3.815605475680718*^9, 
  3.815605492862381*^9}},ExpressionUUID->"beff1378-aec7-4cbf-abbb-\
21123b8c5fe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute rhs", "Section",
 CellChangeTimes->{{3.769318572114345*^9, 
  3.7693185760077257`*^9}},ExpressionUUID->"fc2b4b96-13b2-4538-8053-\
01b64b54b94a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"case", ",", "\"\<Stokes\>\""}], "]"}], ",", 
    RowBox[{
     RowBox[{"w", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
     
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"w", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "+", 
      RowBox[{
       RowBox[{"uN", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       RowBox[{"n", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}]}]}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"w", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7789628974867277`*^9, 3.778962917980281*^9}, {
   3.778962954564888*^9, 3.778963045089972*^9}, {3.7789632456839027`*^9, 
   3.7789632527106256`*^9}, 3.815605526639052*^9, {3.81561292963507*^9, 
   3.8156129456245213`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"42d40d8c-4c91-40d8-b5d6-6fe29fe702d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ",", 
       "t"}], "]"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
     RowBox[{
      RowBox[{"conv", "[", 
       RowBox[{"w", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "[", 
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "]"}]}],
     "-", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", " ", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
      RowBox[{
       RowBox[{"surfMatDiv", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Es", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
         RowBox[{"u", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
         "]"}], "+", 
        RowBox[{
         RowBox[{"uN", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
         RowBox[{"H", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}]}], 
       "]"}]}]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uN", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
        RowBox[{"u", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"surfGrad", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
        RowBox[{"uN", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
        "]"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"surfGrad", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
     RowBox[{"p", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "]"}]}], 
   "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.769319895314584*^9, 3.769319975491631*^9}, {
   3.769320243418973*^9, 3.769320262562801*^9}, {3.769320294936915*^9, 
   3.769320314048999*^9}, {3.769320619382905*^9, 3.769320630698365*^9}, 
   3.769324592791933*^9, 3.7693249069906178`*^9, {3.769326445959626*^9, 
   3.769326457293791*^9}, {3.7693298628827457`*^9, 3.769329865569117*^9}, 
   3.7693991151249027`*^9, {3.778711197434401*^9, 3.778711200458288*^9}, {
   3.778798125964525*^9, 3.778798157498057*^9}, {3.7787982477511673`*^9, 
   3.778798269414484*^9}, 3.7787996153575*^9, 3.778799783039954*^9, {
   3.778961925888402*^9, 3.778961936056728*^9}, {3.7789619864665203`*^9, 
   3.778962001843202*^9}, 3.77896203427569*^9, {3.778963282010942*^9, 
   3.778963294478685*^9}, {3.7789633717809143`*^9, 3.7789633780733356`*^9}, {
   3.778963416477004*^9, 3.778963449307406*^9}, 3.77957760592642*^9, {
   3.815270134170761*^9, 3.815270150848308*^9}, {3.815605615682179*^9, 
   3.815605622997253*^9}, {3.815606209528405*^9, 3.815606213153982*^9}, {
   3.815606327453841*^9, 3.8156063476903973`*^9}, {3.81560639007125*^9, 
   3.8156063943004704`*^9}, 3.815606564965044*^9, {3.815606669505299*^9, 
   3.8156067307514877`*^9}, {3.815606820650979*^9, 3.815606827273367*^9}, {
   3.8156069099223337`*^9, 3.815606942089341*^9}, {3.815607019768457*^9, 
   3.815607108275077*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"c222fbfc-e107-4f2e-8ea4-4033b7ffa77b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"point", ",", "tRand"}], "]"}], ".", 
   RowBox[{"n", "[", 
    RowBox[{"point", ",", "tRand"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.815607293507386*^9, 3.815607347113068*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"f5b3ef7b-1158-4fef-8b97-a16c806f4925"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "t_"}], "]"}], "=", 
  RowBox[{"-", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"surfVectDiv", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "]"}], 
     "+", 
     RowBox[{
      RowBox[{"uN", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
      RowBox[{"Tr", "[", 
       RowBox[{"H", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
       "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.769324087660973*^9, 3.7693240878183928`*^9}, {
   3.769324972232225*^9, 3.769325003381433*^9}, {3.769327785362866*^9, 
   3.769327794393104*^9}, {3.7694051388289633`*^9, 3.7694051418821173`*^9}, 
   3.7694074461852493`*^9, 3.778711454601924*^9, 3.778887553871661*^9, {
   3.7789634687908792`*^9, 3.778963472049315*^9}, {3.815607380203476*^9, 
   3.8156074591268377`*^9}, {3.8156133073577833`*^9, 3.815613313248591*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"5bdf676c-62bd-4b0e-9839-91a308b4e66b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportCPP", "[", "u_", "]"}], ":=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"ToLowerCase", "@", 
     RowBox[{"ToString", "@", 
      RowBox[{"CForm", "@", 
       RowBox[{"N", "@", "u"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<p[0]\>\""}], ",", 
      RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<p[1]\>\""}], ",", 
      RowBox[{"\"\<z\>\"", "\[Rule]", "\"\<p[2]\>\""}], ",", 
      RowBox[{"\"\<power\>\"", "\[Rule]", "\"\<std::pow\>\""}], ",", 
      RowBox[{"\"\<sqrt\>\"", "\[Rule]", "\"\<std::sqrt\>\""}], ",", 
      RowBox[{"\"\<\[Nu]\>\"", "\[Rule]", "\"\<nu\>\""}], ",", 
      RowBox[{"\"\<arccos\>\"", "\[Rule]", "\"\<std::acos\>\""}], ",", 
      RowBox[{"\"\<arcsin\>\"", "\[Rule]", "\"\<std::asin\>\""}], ",", 
      RowBox[{"\"\<\[Delta]0\>\"", "\[Rule]", "\"\<delta_0\>\""}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.769399423989709*^9, 3.769399467207836*^9}, {
  3.769399498567507*^9, 3.769399658813589*^9}, {3.769405704700448*^9, 
  3.769405705255621*^9}, {3.7787113204975986`*^9, 3.778711333409017*^9}, {
  3.778889320439937*^9, 3.778889331410605*^9}, {3.782928739814102*^9, 
  3.782928776555087*^9}, {3.78292897379248*^9, 3.782928982273739*^9}, {
  3.782933708132349*^9, 3.782933730627324*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"2e9f26b0-cc31-4fa1-98ed-77fee372594c"],

Cell[BoxData[
 RowBox[{"exportCPP", "[", 
  RowBox[{"mg", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0mlI03Ecx/FNZeSRGR6BZktTkgyckFZS2/5LrOZkugqaLTRn5cgrbU7D
TSWwNC/URO1wCJaZypxWZpclXZjXJgZhZcJGxxBHZSqm/T6/B19eT768H30C
UrJkpx1YLFYEOajI6feu9rYx05F+m2BehkQMM+ecEqDywWUl9BgMU0FTErcI
npFWUTODzKXQQd1WCf88mWBqiTVGqQjuYw/FQlFLmwT25XYfg1dCQuWw9mOW
Eubp2tKgRvNoDdYLDrHqiA2G6MhKH9LzObEbRjFzArgaaqeuLDOHYevtdAm8
dn34CHxe4S+n+od/TdhuY0aDu6iLY9nLsE6npnZH56xBk1JDbdmyzllG5Htx
qXOXZryg6s0SNW6rw9lCYsDjoDSY2PXzbTsx6lbQO2j6rRiHxdxWM7zAeT8P
Nxes/IUazX72Xfz32KkvpfddoMVN4AqP8+c9YKlnnCf8VvDDeYRY3lHiAp06
jSNjRLf+furirHYSTpbcm4KzVWbOODG+PNYVBupWd0HLv9E9UD/NF8AJ1Y1o
mCLsGVKH2JhnjedeQ94HccDJMNKbWQiEC8vsCJifKqIGf1/bCy8WaqOg0TXn
AEyuHIiBvqKrMpge+IJaxTuqpx3+qzvQb8DSDcXxvgbY5C67mUQM0YfpYXHR
tAEuJZ7qhcKmpwdHkm2MtbRDDHnhZsaYQfbYIBFB+1RxGVSwrVSTZbgach62
10ChsLEe5q8fpPIMVvdeoj5r4wbIi5F6wgp1lw/cueAo7yPmfW6mWn+tJkGV
u2MylHzZlgrLtDuonfZP2bC8Pvc8/A+U0px9
  "],
 CellLabel->"In[73]:=",ExpressionUUID->"1d3baf84-4409-4456-9f27-3c84404c6aa3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1853, 1025},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 212, 5, 31, "Input",ExpressionUUID->"cb7e5e64-ade4-465f-b1a2-1979b9dc3e13"],
Cell[CellGroupData[{
Cell[795, 29, 179, 3, 99, "Title",ExpressionUUID->"ddff3a6e-de58-4dc2-a5f6-6aba49abab55"],
Cell[CellGroupData[{
Cell[999, 36, 154, 3, 68, "Section",ExpressionUUID->"24d33754-7378-44e1-be37-ff2a0ec28ec6"],
Cell[1156, 41, 881, 13, 31, "Input",ExpressionUUID->"1b465777-73e9-484f-ac7e-1989af4e14e2"],
Cell[2040, 56, 8857, 254, 927, "Input",ExpressionUUID->"a7d83c33-6ec5-4367-ba96-a9bfbcbb65dc"],
Cell[10900, 312, 6578, 180, 331, "Input",ExpressionUUID->"cef2d6ba-4484-4616-8d39-ed15a2198b77"],
Cell[17481, 494, 1564, 42, 55, "Input",ExpressionUUID->"f656aa0a-5efd-4d98-b8d2-1a7d6fbf2811"],
Cell[19048, 538, 7872, 244, 303, "Input",ExpressionUUID->"ce38ec79-34d2-4b62-a452-7b3a352b89f5"],
Cell[26923, 784, 23818, 598, 1556, "Input",ExpressionUUID->"0f8c0ba2-eb8b-41c2-b166-6c19debf3f90"],
Cell[50744, 1384, 5792, 146, 270, "Input",ExpressionUUID->"86e35e52-edc1-4aa3-a7ea-6a9365d2723a"],
Cell[56539, 1532, 5928, 163, 216, "Input",ExpressionUUID->"f244ed08-f346-4574-9de5-71269a36e9a1"],
Cell[62470, 1697, 576, 14, 31, "Input",ExpressionUUID->"f45caea6-abb7-4072-a20a-bd1397219bf9"],
Cell[63049, 1713, 2681, 65, 124, "Input",ExpressionUUID->"beff1378-aec7-4cbf-abbb-21123b8c5fe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65767, 1783, 158, 3, 68, "Section",ExpressionUUID->"fc2b4b96-13b2-4538-8053-01b64b54b94a"],
Cell[65928, 1788, 1482, 42, 55, "Input",ExpressionUUID->"42d40d8c-4c91-40d8-b5d6-6fe29fe702d3"],
Cell[67413, 1832, 4459, 114, 124, "Input",ExpressionUUID->"c222fbfc-e107-4f2e-8ea4-4033b7ffa77b"],
Cell[71875, 1948, 349, 8, 31, "Input",ExpressionUUID->"f5b3ef7b-1158-4fef-8b97-a16c806f4925"],
Cell[72227, 1958, 1338, 34, 31, "Input",ExpressionUUID->"5bdf676c-62bd-4b0e-9839-91a308b4e66b"],
Cell[73568, 1994, 1403, 27, 55, "Input",ExpressionUUID->"2e9f26b0-cc31-4fa1-98ed-77fee372594c"],
Cell[74974, 2023, 1131, 23, 31, "Input",ExpressionUUID->"1d3baf84-4409-4456-9f27-3c84404c6aa3"]
}, Open  ]]
}, Open  ]]
}
]
*)

